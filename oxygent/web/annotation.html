<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./image/group-favicon.png" type="image/x-icon">
    <title>QAÊ†áÊ≥®Âπ≥Âè∞ - OxyGent</title>
    <link rel="stylesheet" href="./css/style.css?v=1">
    <link rel="stylesheet" href="./css/annotation.css?v=11">
</head>
<body>
<div class="annotation-wrapper">
    <!-- È°∂ÈÉ®ÂØºËà™ -->
    <header class="annotation-header">
        <div class="logo">
            <img src="./image/group-favicon.png" alt="Logo">
            <h1>QAÊ†áÊ≥®Âπ≥Âè∞</h1>
        </div>
        <div class="header-actions">
            <button class="btn btn-secondary btn-small" onclick="handleInitIndices()" title="ÂàùÂßãÂåñESÁ¥¢Âºï">
                ÂàùÂßãÂåñÁ¥¢Âºï
            </button>
            <button class="btn btn-secondary btn-small" onclick="window.open('index.html', '_blank')">
                ËøîÂõû‰∏ªÈ°µ
            </button>
        </div>
        <div class="user-info">
            <div class="user-role" id="userRole">Ê†áÊ≥®Âëò</div>
            <select onchange="switchRole(this.value)" class="role-select">
                <option value="annotator">Ê†áÊ≥®Âëò</option>
                <option value="reviewer">ÂÆ°Ê†∏Âëò</option>
                <option value="admin">ÁÆ°ÁêÜÂëò</option>
            </select>
        </div>
    </header>

    <!-- ‰∏ª‰ΩìÂÜÖÂÆπ -->
    <main class="annotation-body">
        <!-- Â∑¶‰æßËæπÊ†è -->
        <aside class="annotation-sidebar" id="annotationSidebar">
            <!-- ÊãñÊãΩË∞ÉÊï¥ÂÆΩÂ∫¶ -->
            <div class="sidebar-resize-handle" id="sidebarResizeHandle"></div>

            <!-- ÂÖ®Â±ÄËøáÊª§Êù°‰ª∂ÔºàÈ°∂Â±ÇÔºâ -->
            <div class="sidebar-section global-filter-section">
                <div class="sidebar-section-header">
                    <span>üîç ÂÖ®Â±ÄËøáÊª§</span>
                </div>
                <div class="filter-content">
                    <!-- Êó∂Èó¥ËåÉÂõ¥ -->
                    <div class="filter-group">
                        <div class="filter-group-title">Êó∂Èó¥ËåÉÂõ¥</div>
                        <div class="filter-row">
                            <input type="datetime-local" id="filterStartTime" class="filter-input-full" title="ÂºÄÂßãÊó∂Èó¥">
                        </div>
                        <div class="filter-row">
                            <input type="datetime-local" id="filterEndTime" class="filter-input-full" title="ÁªìÊùüÊó∂Èó¥">
                        </div>
                    </div>

                    <!-- Âø´ÈÄüÁ≠õÈÄâ -->
                    <div class="filter-group">
                        <div class="filter-group-title">Âø´ÈÄüÁ≠õÈÄâ</div>
                        <div class="filter-row">
                            <select class="filter-select-full" id="filterStatus" onchange="applyFilters()">
                                <option value="">ÂÖ®ÈÉ®Áä∂ÊÄÅ</option>
                                <option value="pending">ÂæÖÊ†áÊ≥®</option>
                                <option value="annotated">Â∑≤Ê†áÊ≥®</option>
                                <option value="approved">Â∑≤ÈÄöËøá</option>
                                <option value="rejected">Â∑≤ÊãíÁªù</option>
                            </select>
                        </div>
                        <div class="filter-row">
                            <select class="filter-select-full" id="filterPriority" onchange="applyFilters()">
                                <option value="">ÂÖ®ÈÉ®Á±ªÂûã</option>
                                <option value="0">P0-Á´ØÂà∞Á´Ø</option>
                                <option value="1">P1-Agent</option>
                                <option value="2">P2-LLM</option>
                                <option value="3">P3-Tool</option>
                                <option value="4">P4-ÂÖ∂‰ªñ</option>
                            </select>
                        </div>
                        <div class="filter-row">
                            <input type="text" class="filter-input-full" id="filterSearch" placeholder="ÊêúÁ¥¢Agent/Input/Output..." oninput="debounce(applyFilters, 500)()">
                        </div>
                    </div>

                    <!-- Âà∑Êñ∞ÊåâÈíÆ -->
                    <div class="filter-actions">
                        <button class="btn btn-primary btn-full" onclick="handleGlobalRefresh()">
                            Êü•ËØ¢
                        </button>
                    </div>
                </div>
            </div>

            <!-- ÂæÖÂØºÂÖ•Âå∫Âüü -->
            <div class="sidebar-section pending-import-section">
                <div class="sidebar-section-header" onclick="toggleSection('pendingImport')">
                    <span>üì• ÂæÖÂØºÂÖ•</span>
                    <span class="section-count" id="pendingCount">0</span>
                    <span class="toggle-icon" id="pendingImportToggleIcon">‚ñº</span>
                </div>
                <div class="section-content" id="pendingImportContent">
                    <!-- È¢Ñ‰º∞ÂæÖÂØºÂÖ•Êï∞Èáè -->
                    <div class="import-preview-card">
                        <div class="preview-stats">
                            <div class="preview-stat">
                                <span class="preview-stat-value" id="previewTracePending">0</span>
                                <span class="preview-stat-label">E2E Trace</span>
                            </div>
                            <div class="preview-stat">
                                <span class="preview-stat-value" id="previewNodePending">0</span>
                                <span class="preview-stat-label">Â≠êËäÇÁÇπ</span>
                            </div>
                            <div class="preview-stat total">
                                <span class="preview-stat-value" id="previewTotalPending">0</span>
                                <span class="preview-stat-label">È¢Ñ‰º∞ÂæÖÂØºÂÖ•</span>
                            </div>
                        </div>

                        <!-- ÂØºÂÖ•ÈÄâÈ°π -->
                        <div class="import-options">
                            <div class="import-row">
                                <label>ÊúÄÂ§ßÊï∞Èáè</label>
                                <input type="number" id="importLimit" value="1000" min="1" max="10000" class="import-input-small">
                                <label class="form-checkbox">
                                    <input type="checkbox" id="importIncludeSubNodes" checked>
                                    Âê´Â≠êËäÇÁÇπ
                                </label>
                            </div>
                        </div>

                        <!-- ÂØºÂÖ•ÊåâÈíÆ -->
                        <div class="import-actions">
                            <button class="btn btn-primary btn-full" id="btnImport" onclick="handleExecuteImport()">
                                ÂºÄÂßãÂØºÂÖ•
                            </button>
                        </div>
                    </div>
                </div>
            </div>

                <!-- Â∑≤ÂØºÂÖ•Âå∫Âüü -->
                <div class="sidebar-section imported-section">
                    <div class="sidebar-section-header" onclick="toggleSection('imported')">
                        <span>‚úÖ Â∑≤ÂØºÂÖ•</span>
                        <span class="section-count" id="importedCount">0</span>
                        <span class="toggle-icon" id="importedToggleIcon">‚ñº</span>
                    </div>
                    <div class="section-content" id="importedContent">
                        <!-- Ê†áÊ≥®ËøõÂ∫¶ÔºàÊÅ¢Â§ç‰∏ä‰∏ÄÁâàÊú¨È£éÊ†ºÔºâ -->
                        <div class="progress-section" id="progressSection">
                            <div class="progress-stats-grid">
                                <div class="progress-stat pending">
                                    <div class="progress-stat-value" id="statPending">0</div>
                                    <div class="progress-stat-label">ÂæÖÊ†áÊ≥®</div>
                                </div>
                                <div class="progress-stat annotated">
                                    <div class="progress-stat-value" id="statAnnotated">0</div>
                                    <div class="progress-stat-label">Â∑≤Ê†áÊ≥®</div>
                                </div>
                                <div class="progress-stat approved">
                                    <div class="progress-stat-value" id="statApproved">0</div>
                                    <div class="progress-stat-label">Â∑≤ÈÄöËøá</div>
                                </div>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar-label">Ê†áÊ≥®ËøõÂ∫¶</div>
                                <div class="progress-bar-track">
                                    <div class="progress-bar-fill approved" id="progressApproved" style="width: 0%"></div>
                                    <div class="progress-bar-fill annotated" id="progressAnnotated" style="width: 0%"></div>
                                    <div class="progress-bar-fill pending" id="progressPending" style="width: 100%"></div>
                                </div>
                                <div class="progress-bar-legend">
                                    <span class="legend-item"><span class="legend-dot approved"></span>Â∑≤ÈÄöËøá</span>
                                    <span class="legend-item"><span class="legend-dot annotated"></span>Â∑≤Ê†áÊ≥®</span>
                                    <span class="legend-item"><span class="legend-dot pending"></span>ÂæÖÊ†áÊ≥®</span>
                                </div>
                            </div>
                        </div>

                        <!-- ÊãíÁªùÊï∞Èáè -->
                        <div class="rejected-section">
                            <span class="rejected-label">Â∑≤ÊãíÁªù</span>
                            <span class="rejected-value" id="statRejected">0</span>
                        </div>
                    </div>
                </div>
        </aside>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ - QAÂàóË°® -->
        <section class="annotation-main">
            <div class="main-header">
                <h2 class="main-title">QAÂàóË°®</h2>
                <div class="main-actions">
                    <span class="main-stats" id="mainStats">ÂÖ± 0 Êù°</span>
                    <button class="btn btn-secondary btn-small" onclick="loadTasks()">
                        Âà∑Êñ∞
                    </button>
                </div>
            </div>

            <!-- QAÂàóË°®Ë°®Ê†º -->
            <div class="qa-table-container">
                <table class="qa-table" id="qaTable">
                    <thead>
                        <tr>
                            <th data-column="id" style="width: 140px;">ID</th>
                            <th data-column="priority" style="width: 60px;">Á±ªÂûã</th>
                            <th data-column="status" style="width: 70px;">Áä∂ÊÄÅ</th>
                            <th data-column="callee" style="width: 100px;">Agent/Tool</th>
                            <th data-column="question" style="width: 35%;">Input</th>
                            <th data-column="answer" style="width: 25%;">Output</th>
                            <th data-column="time" style="width: 100px;">Êó∂Èó¥</th>
                            <th data-column="action" style="width: 60px;">Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody id="qaTableBody">
                        <!-- Áî±JSÊ∏≤Êüì -->
                    </tbody>
                </table>

                <div class="empty-state" id="emptyState">
                    <img src="./image/empty.svg" alt="">
                    <p>ÊöÇÊó†QAÊï∞ÊçÆÔºåËØ∑ÂÖàÂØºÂÖ•Êï∞ÊçÆ</p>
                </div>
            </div>

            <!-- ÂàÜÈ°µ -->
            <div class="pagination">
                <span class="pagination-info" id="paginationInfo">Á¨¨ 1/1 È°µÔºåÂÖ± 0 Êù°</span>
                <div class="pagination-btns" id="paginationBtns">
                    <button class="pagination-btn" onclick="changePage(1)">È¶ñÈ°µ</button>
                    <button class="pagination-btn" onclick="changePage(state.currentPage - 1)">‰∏ä‰∏ÄÈ°µ</button>
                    <span class="page-num" id="pageNum">1</span>
                    <button class="pagination-btn" onclick="changePage(state.currentPage + 1)">‰∏ã‰∏ÄÈ°µ</button>
                    <button class="pagination-btn" onclick="changePage(state.totalPages)">Êú´È°µ</button>
                </div>
            </div>
        </section>
    </main>
</div>

<!-- Âè≥‰æßÊäΩÂ±â - ‰ªªÂä°ËØ¶ÊÉÖ‰∏éÊ†áÊ≥® -->
<div class="drawer-overlay" id="drawerOverlay" onclick="closeDrawer()"></div>
<aside class="drawer" id="detailDrawer">
    <div class="drawer-header">
        <h2 class="drawer-title">‰ªªÂä°ËØ¶ÊÉÖ</h2>
        <button class="drawer-close" onclick="closeDrawer()">√ó</button>
    </div>
    <div class="drawer-body" id="drawerBody">
        <!-- Áî±JSÊ∏≤Êüì -->
    </div>
</aside>

<script src="./js/annotation.js?v=15"></script>
</body>
</html>
